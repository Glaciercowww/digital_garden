## 1. Introduction

occlusion handling problem

## 2.Taxonomy of problems
### 1. Amodal Shape Completion（非模态形状补全）

非模态形状补全是指利用部分视觉证据推测物体的完整形状，包括被遮挡部分的形状推测。这一任务的目标是恢复物体的整体轮廓，从而更好地理解场景中的物体大小和相对深度。为了实现这一目标，主要采用以下几种方法：

- **Amodal Instance Segmentation（非模态实例分割）**：
    
    - 这是最常用的非模态形状补全技术，其目标是预测一个实例的完整分割掩码（包括可见和不可见部分）。
    - 例如，Mask R-CNN 模型经过扩展后可以实现非模态形状补全，而不是仅仅关注可见部分的分割。
    - 根据是否结合目标检测技术，可以将这些方法分为两大类：
        1. **结合目标检测的非模态实例分割**：
            - 首先使用目标检测方法获取目标所在区域（如边界框），然后在候选区域内进行像素级分割，生成物体的分割掩码。
            - 例如，Li 和 Malik（2016）提出的 IBBE 方法，通过迭代地调整边界框，逐步推测物体的完整形状。
        2. **不结合目标检测的非模态实例分割**：
            - 直接在像素级别进行形状补全，而不依赖于目标检测框。
            - 例如，基于深度学习的 AmodalMask（Zhu et al., 2017）模型通过输入图像块预测被遮挡物体的非模态掩码。
- **几何形状补全方法**：
    
    - 一些早期的研究尝试使用几何模型（如 Euler 螺旋、直线和贝塞尔曲线）来推测被遮挡部分的形状。
    - 这些方法通常只适用于简单形状（如直线或圆形），在复杂场景中效果较差。


### 2. Amodal Appearance Completion（非模态外观补全）
非模态外观补全的目标是恢复被遮挡部分的物体表面外观（即 RGB 值），使得物体看起来完整且一致。大多数当前的非模态外观补全方法都依赖于从非模态形状补全中获得的形状掩码，分为以下几种类型：

- **物体中心表示（Object-centric Representations for Toy Datasets）**：
    
    - 主要用于简单的玩具数据集，例如 MONet 和 IODINE，使用变分自编码器（VAE）结合注意力机制来重建物体的外观。
    - 这些方法主要在颜色对比度明显的简单背景下有效，难以应用于复杂场景。
- **特定类别的外观补全（Category-specific Studies）**：
    
    - 针对某些特定类型的物体（如车辆或人体）进行非模态外观补全。
    - 例如，Yan 等人（2019）提出了一个 GAN-based 的框架，用于恢复被遮挡车辆的外观，而 Zhou 等人（2021）提出了一种用于人体外观补全的 Unet 模型。
- **复杂场景的外观补全（Methods for Complex Scenes）**：
    
    - 针对真实场景中较复杂的物体或背景进行外观补全。
    - 这些方法通常需要使用合成数据进行训练，如 SeGAN（Ehsani et al., 2018）使用 cGAN 来生成物体的被遮挡部分的外观。

### 3. Order Perception（顺序感知）

顺序感知是指理解物体在场景中的相互遮挡关系（Occlusion Order）或深度关系（Layer Order），并依此推测物体的排列顺序。顺序感知可以帮助提升形状和外观补全的精度：

- **Occlusion Order（遮挡顺序）**：
    
    - 通过推测物体间的遮挡关系（如物体 A 遮挡物体 B），来辅助形状和外观补全任务。
    - 例如，BCNet（Ke et al., 2021）使用图卷积网络（GCN）将重叠区域划分为不同的遮挡层，从而分离遮挡物和被遮挡物。
- **Layer Order（图层顺序）**：
    
    - 图层顺序主要用于确定物体的深度关系（前景和背景的关系）。
    - 例如，一些研究将场景划分为前景和背景两个层（Dhamo et al., 2019），或使用多图层结构表示更复杂的物体深度关系（Zheng et al., 2021）。


## 3.Datasets and evaluation
### 3.1Data collection
#### 1. **Manual Annotation（手动标注）**

手动标注是指通过人工方式对图像进行标注，即由人类标注者根据视觉感知能力来预测物体的被遮挡部分，并手动标注这些不可见区域的轮廓或外观。这种方法是图像非模态补全领域中最直接、最传统的标注方式，具有较高的准确性和一致性，但其缺点在于标注成本高且耗时耗力。

- **具体描述**：
    
    - 标注者通常需要通过想象物体的被遮挡部分来标记物体的完整轮廓（例如，将物体看作完全可见的形式进行标注），从而生成非模态分割掩码（amodal segmentation mask）或相应的边界框。
    - 标注者之间的意见可能会有差异，但 Zhu et al. (2017) 的研究表明，人类标注者在预测被遮挡区域时通常具有较高的一致性。
    - 这一方法通常用于生成非模态形状补全（amodal shape completion）和遮挡顺序（occlusion order）的标注数据集。
- **优点**：
    
    - 由于是由人类标注者依据真实的视觉经验进行标注，标注结果往往具有较高的质量和一致性。
    - 可以提供复杂场景中不同物体类别的完整形状标注，从而为模型提供精确的非模态分割掩码。
- **局限性**：
    
    - 标注成本高：手动标注数据集需要投入大量的人工资源和时间。
    - 标注结果通常仅限于物体的非模态形状（即掩码或轮廓），无法提供被遮挡区域的 RGB 外观信息。
- **代表性数据集**：
    
    - COCOA（Zhu et al., 2017）数据集：手动标注了 COCO 数据集中部分图像的非模态分割掩码和物体间的遮挡顺序。
    - KINS（Qi et al., 2019）数据集：在 KITTI 数据集上进行了车辆和行人的手动标注，生成了非模态分割掩码和相对遮挡顺序信息。

 #### 2. **Clip-art-based Image Composition（基于剪贴画的图像合成）**

基于剪贴画的图像合成是一种较为低成本的方式，通过将现有图像中剪切出的物体片段（patches）叠加到目标图像上，从而模拟被遮挡的场景。这种方法可以为模型提供大规模的非模态外观数据，但其生成的图像通常不够真实，并且容易产生伪影（artifacts）。

- **具体描述**：
    
    - 研究人员首先将某些目标物体（例如汽车、人物）的图像块从背景中剪切出来，然后将这些图像块叠加到另一幅目标图像中，形成遮挡关系。
    - 通过剪贴画合成的方式，可以自动生成物体的非模态分割掩码和完整外观（RGB appearance）。
    - 由于物体是从原图中剪切出来的，因此可以在合成图像中准确地提供被遮挡部分的外观数据。
- **优点**：
    
    - 标注成本低：相比手动标注，通过合成方式可以快速生成大规模的非模态数据集。
    - 提供了被遮挡区域的完整外观标注，而不仅仅是物体轮廓，从而适用于非模态外观补全任务。
- **局限性**：
    
    - 只能处理通过剪贴画叠加产生的遮挡，难以处理复杂背景中的多物体遮挡。
    - 合成图像可能会因为拼接过程而出现不自然的边界或纹理伪影，影响训练效果。
    - 难以模拟复杂真实场景中的光照变化和深度关系，合成图像的逼真度和多样性不足。
- **代表性数据集**：
    
    - D2S Amodal（Follmann et al., 2019）：通过叠加超市商品的图像片段生成了大量具有非模态分割掩码的合成图像。
    - OVD（Yan et al., 2019）：通过将 COCO 数据集中的物体剪贴到车辆图像上，生成了被遮挡车辆的合成图像，并提供了车辆的完整外观标注。

#### 3. **Synthetic 2D Images from 3D Scenes（基于合成场景的2D图像生成）**

这种方式通过构建 3D 场景，然后生成相应的 2D 图像，从而获得完整的物体标注。合成的 3D 场景能够精确地控制物体的遮挡关系、深度信息和 RGB 外观，因此可以生成高质量的标注数据集，并且能够提供物体间的复杂交互信息。

- **具体描述**：
    - 首先在 3D 环境中构建一个包含多个物体的场景（如模拟街景或室内场景），然后通过改变视角来生成不同的 2D 图像。
    - 这些合成图像可以提供物体的非模态分割掩码、完整的 RGB 外观、深度信息（Depth Map）以及遮挡关系（Occlusion Order）。
    - 由于这些图像是从 3D 模型生成的，因此可以轻松获取物体的完整形状和外观，而不受遮挡的影响。
- **优点**：
    
    - 标注结果高度精确且具有多样性：合成场景中可以任意控制物体的姿态、位置、遮挡关系和光照条件，从而生成具有高度准确性的标注数据。
    - 提供丰富的场景信息：如深度图、遮挡顺序、物体间的空间关系等，可以辅助非模态形状和外观补全任务。
- **局限性**：
    
    - 合成场景的构建通常需要复杂的3D建模技术和渲染过程，生成数据集的成本较高。
    - 合成图像的视觉效果和细节可能与真实场景存在较大差距，导致模型在真实场景中的泛化能力不足。
- **代表性数据集**：
    
    - SAIL-VOS（Hu et al., 2019）：使用 GTA-V 环境模拟生成了大量室内和室外场景的图像，并对其中的物体进行了完整标注。
    - CSD（Zheng et al., 2021）：在合成的室内场景中生成了具有多遮挡关系的图像，提供了丰富的非模态形状和外观标注。
#### 4. **总结**

这一部分系统性地总结了图像非模态补全任务中常用的数据集生成方式，并详细分析了每种方式的优点和局限性。对于不同的研究任务，可以根据任务需求选择合适的数据集构建方法。

- **手动标注** 适用于需要高质量、精确形状标注的任务，但成本高昂。
- **基于剪贴画的图像合成** 适用于大规模数据集的生成，但生成图像的质量受限于拼接过程。
- **基于 3D 场景的合成图像** 能够提供高质量的标注数据，但在视觉效果上可能与真实场景存在差距。

 
### 3.2 Datasets
#### 1. **数据集的分类与应用场景**

该部分将现有数据集分为三大类，分别是：

1. **Common Objects Datasets（通用物体数据集）**
2. **Vehicle Datasets（车辆数据集）**
3. **Specialized Datasets（专用数据集：人体、室内场景等）**

#### 2. **Common Objects Datasets（通用物体数据集）**

这些数据集通常包含多种物体类别（例如日常用品、动物、人类等），并且提供了被遮挡物体的完整形状或外观标注。该类数据集旨在提供多类别、多场景的标注，用于模型在通用场景中的训练和评估。

1. **COCOA（COCO Amodal）——Zhu et al., 2017**：
    
    - **来源**：基于 COCO 数据集（Common Objects in Context）生成。
    - **标注类型**：
        - 提供 **非模态实例分割掩码**（amodal segmentation mask），即包含物体被遮挡部分的完整分割轮廓。
        - 标注了物体之间的 **遮挡顺序（occlusion order）**。
    - **应用场景**：该数据集可用于通用物体的非模态形状补全及遮挡顺序推理任务。
    - **局限性**：
        - 标注内容较为单一，仅提供物体形状和遮挡顺序信息，而不包含被遮挡部分的 RGB 外观。
2. **COCOA-cls（COCOA with Class-specific Labels）——Follmann et al., 2019**：
    
    - **来源**：基于 COCOA 数据集，但为物体提供了 **类别特定的非模态标注**（class-specific annotations）。
    - **标注类型**：
        - 提供每个物体的类别标签，以及每类物体的非模态分割掩码。
    - **应用场景**：用于多物体类别的非模态分割和类别识别任务。
3. **InstaOrder——Lee and Park, 2022**：
    
    - **来源**：同样基于 COCO 数据集，但专注于物体间的几何顺序标注。
    - **标注类型**：
        - 提供 **双向遮挡顺序（Bidirectional Occlusion Order）** 和物体间的 **深度顺序（Depth Order）**。
    - **局限性**：仅包含 **模态分割掩码**（modal segmentation masks），而非完整的非模态分割信息。
4. **D2S Amodal——Follmann et al., 2019**：
    
    - **来源**：基于 Densely Segmented Supermarket (D2S) 数据集进行生成。
    - **标注类型**：
        - 提供超市商品的非模态掩码（amodal masks），所有物体被人工合成遮挡关系。
    - **应用场景**：该数据集用于超市商品及日常用品的遮挡关系分析与非模态分割。

---

#### 3. **Vehicle Datasets（车辆数据集）**

车辆数据集专注于交通场景中车辆的非模态补全，包括被遮挡车辆的形状、外观、遮挡顺序等。由于车辆类别的形状和结构相对稳定，因此这些数据集主要用于训练和评估车辆形状和外观的补全模型。

1. **KINS（KITTI INStance）——Qi et al., 2019**：
    
    - **来源**：基于 KITTI 数据集的交通场景图像。
    - **标注类型**：
        - 提供车辆和行人的 **非模态分割掩码** 及物体间的 **相对遮挡顺序（Relative Occlusion Order）**。
    - **应用场景**：适用于城市交通场景中的车辆形状补全和遮挡顺序推理任务。
2. **OVD（Occluded Vehicle Dataset）——Yan et al., 2019**：
    
    - **来源**：基于 Cars 数据集，通过合成方法生成。
    - **标注类型**：
        - 提供被遮挡车辆的 **完整 RGB 外观（RGB appearance）**，以及合成遮挡物体的位置和类别。
    - **应用场景**：用于训练车辆的外观补全模型，并评估模型对复杂遮挡场景的泛化能力。
3. **Amodal Cityscapes——Breitenstein and Fingscheidt, 2022**：
    
    - **来源**：基于 Cityscapes 数据集生成。
    - **标注类型**：
        - 提供城市交通场景中车辆和行人的 **非模态分割掩码**，以及遮挡顺序标注。
    - **特点**：
        - 模拟复杂交通场景中的遮挡关系（如行人穿行、车辆重叠等），标注精细度较高。
4. **KITTI-360-APS 和 BDD100K-APS——Mohan and Valada, 2022a**：
    
    - **来源**：分别基于 KITTI-360 和 BDD100K 数据集进行扩展。
    - **标注类型**：
        - 提供城市交通场景中的 **非模态全景标注（amodal panoptic annotations）**。
        - 标注包括 "stuff" 类（如道路、建筑物）和 "thing" 类（如车辆、行人）。
    - **应用场景**：用于复杂交通场景中不同类别的遮挡与顺序推理任务。

---

#### 4. **Specialized Datasets（专用数据集：人体、室内场景等）**

这些数据集专注于特定类别（如人体）或特定场景（如室内环境），为特定任务（如人体姿态补全或室内场景分割）提供详细标注。

1. **AHP（Amodal Human Parsing）——Zhou et al., 2021**：
    
    - **标注类型**：
        - 提供 **人体姿态和外观的非模态分割掩码及外观信息**。
    - **应用场景**：用于人体姿态补全和遮挡推理任务。
2. **CSD（Composite Scene Dataset）——Zheng et al., 2021**：
    
    - **来源**：在 3D 合成室内场景中生成。
    - **标注类型**：
        - 提供室内场景中物体的 **非模态掩码、RGB 外观及遮挡顺序**。
    - **特点**：适用于复杂室内场景中的物体补全与遮挡顺序推理。
#### 5. **总结**

论文通过对现有非模态补全数据集的分类与总结，为不同场景和任务提供了详细的数据集参考。这些数据集在标注类型、应用场景、遮挡关系和标注精细度上各有侧重，可用于不同任务的模型训练和评估。



论文的 **3.3. Evaluation metrics and latest benchmark results on the amodal datasets（评估指标与最新基准结果）** 部分，主要讨论了图像非模态补全（image amodal completion）任务中常用的评估指标以及现有数据集上的基准模型表现。由于非模态补全涉及到恢复被遮挡区域的物体形状、外观及遮挡关系，因此在评估时需要考虑形状、外观、深度关系、遮挡顺序等多个方面的指标。该部分为研究人员提供了一个系统的框架，帮助他们更好地理解现有模型的优劣，并为未来研究提供参考。

### 3.3Evaluation metrics and latest benchmark results on the amodal datasets（评估指标与最新基准结果）
在非模态补全任务中，模型的性能通常通过以下几种主要评估指标来衡量。根据任务目标和具体应用场景，这些评估指标可分为针对 **形状补全**、**外观补全** 以及 **顺序推理** 的不同指标。以下是对主要指标的详细描述：
#### 3.3.1 Amodal Shape Completion

- **目标**：针对遮挡形状的补全任务，常用评估指标包括 `IoU（Intersection over Union）`、`mIoU（Mean IoU）`、`Precision（精确率）`、`Recall（召回率）`、`F1-score` 及 `mAP（mean Average Precision）`。通常 mAP 是最常用的指标。
- **数据集**：主要使用 COCOA 和 KINS 两个数据集来评估基准表现，分别在 `Amodal Instance Segmentation` 任务中测试多种方法的表现：
    - 如 ORCNN、ASN（Mask-RCNN）、PCNet、BCNet、CSDNet 及 Shape Prior 方法。
- **结果**：在 COCOA 和 KINS 数据集上，不同方法取得的 mAP 分数有所不同，最高分为 Shape Prior 方法在 COCOA 数据集上达到 35.4%。

#### 3.3.2 Amodal Appearance Completion

- **目标**：该任务的重点在于预测物体不可见部分的外观和细节纹理。为了评估图像的生成质量，研究者常采用以下指标：
    - **MSE（Mean Square Error）**、**RMSE（Root Mean Square Error）**、**PSNR（Peak Signal-to-Noise Ratio）**、以及更复杂的视觉感知度量标准，如 **SSIM（Structural Similarity Index）** 和 **FID（Fréchet Inception Distance）**。
- **数据集**：该任务中使用的主要数据集包括：
    - **CSD（Zheng et al., 2021）** 和 **AHP（Zhou et al., 2021）**，分别测试不同模型在生成图像外观上的表现。
    - 在 SSIM 和 PSNR 评估中，CSDNet 达到了 0.91 和 35.24 的得分。

#### 3.3.3 Order Perception

- **目标**：研究任务包括遮挡顺序（Occlusion Order）和图层顺序（Layer Order）的感知与预测。
- **遮挡顺序**：针对成对物体实例的遮挡顺序，使用以下评估指标：
    - **Pairwise Depth Ordering Accuracy（成对深度顺序精度）**、**Precision、Recall、F1-score** 以及 **Pairwise Ordering Average Precision**。
    - 数据集包括 COCOA、KINS 和 InstaOrder 数据集，用于测试不同模型的顺序恢复能力。
- **图层顺序**：图层顺序任务中使用 `RMSE（均方根误差）`、`REL（相对误差）` 及多种基于阈值的准确性指标。此外，还可采用 `Damerow–Levenstein 距离` 来计算预测顺序与真实顺序之间的最小操作次数。

## 4. 应用总结
图像 Amodal 补全技术在许多实际应用中具有重要价值，涵盖了自动生成 Amodal 标注、场景编辑和重构、减弱现实（Diminished Reality）、机器人抓取系统、自动驾驶和新视角合成等场景。

1. **自动生成 Amodal 标注**： 手动标注 Amodal 数据集非常昂贵且耗时，因为这要求标注者对不可见部分进行合理推测。为了降低标注成本，现有的方法能够通过将已有的 Modal 标注转化为伪 Amodal 标注，从而生成高质量的 Amodal 掩码。这些自动生成的掩码甚至在某些任务上超越了手动标注，提供了比人工标注更细致和自然的结果。
    
2. **场景编辑和重构**： Amodal 补全任务能够将场景中的物体与背景进行分离，同时还提供了物体间的层次顺序信息。这些信息能够用于对象顺序的交换、物体移除或复制，从而使场景编辑更为方便，特别是在移除大型遮挡物时（如移除照片中的人群或车辆）。Amodal 补全技术还在隐私保护应用中大有作为，例如移除敏感物体时，可以更自然地填充被遮挡的背景部分。
    
3. **减弱现实（Diminished Reality，DR）**： DR 技术通过去除场景中的不必要实体来提升用户体验，是 AR（增强现实）技术的补充。在应用场景中，DR 技术能够移除用户不希望看到的障碍物，并填补缺失的图像信息。这对于例如虚拟家具展示等场景非常有用，能够有效提升产品展示效果。
    
4. **机器人抓取系统**： 在实际环境中，机器人经常需要应对被遮挡的目标物体。Amodal 补全技术能够帮助机器人理解遮挡关系和目标物体的形状，从而在复杂环境中更好地规划抓取策略，并避免在操作过程中发生碰撞。
    
5. **自动驾驶**： 自动驾驶系统需要对道路上的各种物体（如车辆、行人和障碍物）进行识别，而这些物体可能被部分遮挡。Amodal 补全能够帮助自动驾驶系统预测物体的完整形状，避免因仅依赖可见部分而导致的错误识别，从而提升驾驶安全性。
    
6. **新视角合成（Novel View Synthesis）**： Amodal 补全能够生成遮挡物后方的完整视角信息，这对于新视角图像生成（如从单一视图合成三维图像）至关重要。该技术通过填补被遮挡区域，从而生成更加完整的 3D 视图，应用于场景重建和虚拟现实中。

## 5.Open issues and future directions
尽管现有的研究在图像Amodal补全领域取得了显著进展，但在实际应用中仍然存在许多挑战。以下是对这些挑战以及未来研究方向的总结：

1. **Amodal数据集的挑战**：现有Amodal数据集的标注主要依赖于人工推测，对于遮挡物体的不可见部分，标注具有一定的主观性。这使得生成更接近真实情况的标注成为一个重要研究方向。未来可能需要开发更真实的数据集，并采用新的成像手段（如X射线）来改进标注的准确性。同时，开发能够完整展示物体不可见部分的真实数据集仍然是一项待解决的挑战。
    
2. **输出结果的多样性**：物体隐藏部分的多样性是Amodal补全任务的自然问题。当只有部分物体可见时，合理的补全方式可能有多种不同可能性。因此，未来研究应探索如何在形状补全、外观补全以及顺序感知任务中更好地表示这些多样性，并考虑多种可能的结果模式。
    
3. **更好的可视化表示**：目前大多数Amodal补全的结果都仅限于二维表示。然而，如何更有效地展示额外推测的信息仍需要进一步研究。未来的研究可能考虑将这些信息构建成2.5D或3D表示，从而提供更直观的结果。
    
4. **联合解决多个子问题**：部分研究已经尝试了对多个子问题的联合解决，但很少有研究对联合解决这些问题的重要性进行深入讨论。未来的研究方向可能集中于阐明子问题间的相互依赖关系，并通过消融实验验证联合解决方案的效果。
    
5. **一致的性能度量标准**：由于该领域尚处于早期阶段，目前对于各个Amodal补全任务缺乏一致的评价标准。因此，未来需要针对每个任务制定统一的性能评估标准，以便更好地进行不同方法间的比较。
    
6. **实时模型**：尽管目前在Amodal补全的理论研究中取得了较大进展，但实际应用仍需要能够在复杂场景中实时处理的模型。未来的研究应重点考虑如何在保持模型性能的同时，提高其实时处理能力。
    
7. **与其他任务或上下文的集成**：Amodal补全任务与目标检测、语义分割和深度估计等其他任务的结合具有很大的潜力。未来的研究可以探索多任务联合的模型设计，并利用其他任务的优势来提升Amodal补全的表现。